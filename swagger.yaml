swagger: '2.0'
info:
  title: DCFB API
  description: API spec for DCFB API.
  version: "0.0.1"
schemes:
  - https
basePath: /v1
securityDefinitions:
  bearer:
    type: apiKey
    name: Authorization
    in: header
security:
  - bearer: []
consumes:
  - application/json;charset=utf-8
produces:
  - application/json;charset=utf-8
paths:

  /items:
    get:
      operationId: listItems
      summary: List items
      description: List items
      parameters:
        - name: categoryIds
          in: query
          description: Filter by category ids (comma delimitered)
          type: string
        - name: search
          in: query
          description: Search by free-text query
          required: false
          type: string
        - name: sort
          in: query
          type: array
          collectionFormat: csv
          items:
            type: string
        - name: firstResult
          in: query
          description: First result
          required: false
          type: integer
          format: int64
        - name: maxResults
          in: query
          description: Max results
          required: false
          type: integer
          format: int64
      tags:
        - Items
      responses:
        200:
          description: An array of items
          schema:
            type: array
            items:
              $ref: '#/definitions/Item'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    post:
      operationId: createItem
      summary: Create item
      description: Create item
      parameters:
        - name: payload
          in: body
          description: Payload
          required: true
          schema:
            $ref: '#/definitions/Item'
      tags:
        - Items
      responses:
        200:
          description: Created item
          schema:
            $ref: '#/definitions/Item'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
  '/items/{itemId}':
    get:
      operationId: findItem
      summary: Finds an item
      description: Find item
      parameters:
        - name: itemId
          required: true
          in: path
          description: Item id
          type: string
          format: uuid
      tags:
        - Items
      responses:
        200:
          description: An item
          schema:
            $ref: '#/definitions/Item'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    put:
      operationId: updateItem
      summary: updates an item
      description: Update item
      parameters:
        - name: itemId
          required: true
          in: path
          description: Item id
          type: string
          format: uuid
        - name: payload
          in: body
          description: Payload
          required: true
          schema:
            $ref: '#/definitions/Item'
      tags:
        - Items
      responses:
        200:
          description: Updated item
          schema:
            $ref: '#/definitions/Item'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    delete:
      operationId: deleteItem
      summary: deletes an item
      description: Delete item
      parameters:
        - name: itemId
          required: true
          in: path
          description: Item id
          type: string
          format: uuid
      tags:
        - Items
      responses:
        204:
          description: Empty resonse indicating a successful removal
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'

  /purchaseRequests:
    get:
      operationId: list purchase requests
      summary: List purchase requests
      description: List purchase requests
      parameters:
        - name: categoryIds
          in: query
          description: Filter by category ids (comma delimitered)
          type: string
        - name: search
          in: query
          description: Search  by free-text query
          required: false
          type: string
        - name: firstResult
          in: query
          description: First result
          required: false
          type: integer
          format: int64
        - name: maxResults
          in: query
          description: Max results
          required: false
          type: integer
          format: int64
      tags:
        - PurchaseRequests
      responses:
        200:
          description: An array of purchase requests
          schema:
            type: array
            items:
              $ref: '#/definitions/PurchaseRequest'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    post:
      operationId: createPurchaseRequest
      summary: Create purchase request
      description: Create purchase request
      parameters:
        - name: payload
          in: body
          description: Payload
          required: true
          schema:
            $ref: '#/definitions/PurchaseRequest'
      tags:
        - PurchaseRequests
      responses:
        200:
          description: Created purchaseRequest
          schema:
            $ref: '#/definitions/PurchaseRequest'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
  '/purchaseRequests/{purchaseRequestId}':
    get:
      operationId: findPurchaseRequest
      summary: Finds an purchaseRequest
      description: Find purchaseRequest
      parameters:
        - name: purchaseRequestId
          required: true
          in: path
          description: PurchaseRequest id
          type: string
          format: uuid
      tags:
        - PurchaseRequests
      responses:
        200:
          description: An array of purchase requests
          schema:
            type: array
            items:
              $ref: '#/definitions/PurchaseRequest'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    put:
      operationId: updatePurchaseRequest
      summary: updates an purchase request
      description: Update purchase request
      parameters:
        - name: purchaseRequestId
          required: true
          in: path
          description: PurchaseRequest id
          type: string
          format: uuid
        - name: payload
          in: body
          description: Payload
          required: true
          schema:
            $ref: '#/definitions/PurchaseRequest'
      tags:
        - PurchaseRequests
      responses:
        200:
          description: Updated purchaseRequest
          schema:
            $ref: '#/definitions/PurchaseRequest'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    delete:
      operationId: deletePurchaseRequest
      summary: deletes an purchase request
      description: Delete purchase request
      parameters:
        - name: purchaseRequestId
          required: true
          in: path
          description: PurchaseRequest id
          type: string
          format: uuid
      tags:
        - PurchaseRequests
      responses:
        204:
          description: Empty resonse indicating a successful removal
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'

  /categories:
    get:
      operationId: listCategories
      summary: List categories
      description: List categories
      parameters:
        - name: parentId
          in: query
          description: Filter by parent category id
          type: string
          format: uuid
        - name: search
          in: query
          description: Search by free-text query
          required: false
          type: string
        - name: sort
          in: query
          type: array
          collectionFormat: csv
          items:
            type: string
        - name: firstResult
          in: query
          description: First result
          required: false
          type: integer
          format: int64
        - name: maxResults
          in: query
          description: Max results
          required: false
          type: integer
          format: int64
      tags:
        - Categories
      responses:
        200:
          description: An array of categories
          schema:
            type: array
            items:
              $ref: '#/definitions/Category'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    post:
      operationId: createCategory
      summary: Create category
      description: Create category
      parameters:
        - name: payload
          in: body
          description: Payload
          required: true
          schema:
            $ref: '#/definitions/Category'
      tags:
        - Categories
      responses:
        200:
          description: Created category
          schema:
            $ref: '#/definitions/Category'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
  '/categories/{categoryId}':
    get:
      operationId: findCategory
      summary: Finds an category
      description: Find category
      parameters:
        - name: categoryId
          required: true
          in: path
          description: Category id
          type: string
          format: uuid
      tags:
        - Categories
      responses:
        200:
          description: A category
          schema:
            $ref: '#/definitions/Category'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    put:
      operationId: updateCategory
      summary: updates an category
      description: Update category
      parameters:
        - name: categoryId
          required: true
          in: path
          description: Category id
          type: string
          format: uuid
        - name: payload
          in: body
          description: Payload
          required: true
          schema:
            $ref: '#/definitions/Category'
      tags:
        - Categories
      responses:
        200:
          description: Updated category
          schema:
            $ref: '#/definitions/Category'
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'
    delete:
      operationId: deleteCategory
      summary: deletes an category
      description: Delete category
      parameters:
        - name: categoryId
          required: true
          in: path
          description: Category id
          type: string
          format: uuid
      tags:
        - Categories
      responses:
        204:
          description: Empty resonse indicating a successful removal
        400:
          description: Invalid request was sent to the server
          schema:
            $ref: '#/definitions/BadRequest'
        403:
          description: Attempted to make a call with unauthorized client
          schema:
            $ref: '#/definitions/Forbidden'
        500:
          description: Internal server error
          schema:
            $ref: '#/definitions/InternalServerError'

definitions:

  LocalizedValue: 
    type: object
    required:
      - language
      - value
      - type
    properties:
      language:
        type: string
        minLength: 2
        maxLength: 2        
      value:
        type: string
      type:
        type: string      
        
  Address:
    type: object
    properties:
      streetAddress:
        description: Street address.
        type: string
      postalCode:
        description: 'Postal code, for example 00010.'
        type: string
      postOffice:
        description: Post office
        type: string
      country:
        description: 'Country code (ISO 3166-1 alpha-2), for example FI.'
        type: string
      additionalInformations:
        description: Localized list of additional information about the address.
        type: array
        items:
          $ref: '#/definitions/LocalizedValue'
          
  Coordinate:
    type: object
    properties:
      crs:
        type: string
      latitude:
        description: latitude coordinate.
        type: string
      longitude:
        description: longitude coordinate.
        type: string
        
  Category:
    type: object
    properties:
      id:
        description: Category id
        type: string
        format: uuid
      parentId:
        description: Category parent id.
        type: string
        format: uuid
      title:
        type: array
        description: Title of the category, multilingual
        items:
          $ref: '#/definitions/LocalizedValue'
      slug:
        description: Category slug
        type: string
      extra:
        type: array
        description: Meta parameters
        items:
          $ref: '#/definitions/Meta'
        
  Price:
    type: object
    properties:
      price:
        type: string
        description: price with two decimal places. e.g. 13.00
      currency:
        description: Currency code (ISO 4217)
        type: string
        
  Location:
    type: object
    required:
    - name
    properties:
      id:
        description: Location id
        type: string
        format: uuid
      name:
        type: array
        description: Name of the location, multilingual
        items:
          $ref: '#/definitions/LocalizedValue'
      coordinate:
        $ref: '#/definitions/Coordinate'
      address:
        $ref: '#/definitions/Address'
  
  Image:
    type: object
    required:
      - url
      - type
    properties:
      id:
        description: Image id
        type: string
        format: uuid
      url:
        description: Image URL
        type: string
      type:
        description: Image type
        type: string

  Item:
    type: object
    required:
      - amount
      - unit
      - unitPrice
    properties:
      id:
        description: Item id
        type: string
        format: uuid
      title:
        type: array
        description: Title of the item, multilingual
        items:
          $ref: '#/definitions/LocalizedValue'
      description:
        type: array
        description: Description of the item, multilingual
        items:
          $ref: '#/definitions/LocalizedValue'
      categoryId:
        description: Category id.
        type: string
        format: uuid
      slug:
        description: Item slug
        type: string
      createdAt:
        type: string
        format: date-time
      modifiedAt:
        type: string
        format: date-time
      expiresAt:
        type: string
        format: date-time
      images:
        type: array
        items: 
          $ref: '#/definitions/Image'
      unitPrice:
        $ref: '#/definitions/Price'
      unit:
        type: string
      amount:
        type: integer
        format: int64
      meta:
        type: array
        description: Item meta
        items:
          $ref: '#/definitions/Meta'

  PurchaseRequest:
    type: object
    properties:
      id:
        description: Purchase request id
        type: string
        format: uuid
      title:
        type: array
        description: Title of the item, multilingual
        items:
          $ref: '#/definitions/LocalizedValue'
      description:
        type: array
        description: Description of the item, multilingual
        items:
          $ref: '#/definitions/LocalizedValue'
      categoryId:
        description: Category id.
        type: string
        format: uuid
      slug:
        description: Item slug
        type: string
      createdAt:
        type: string
        format: date-time
      modifiedAt:
        type: string
        format: date-time
      expiresAt:
        type: string
        format: date-time
      unit:
        type: string
      amount:
        type: number
        format: int64
      meta:
        type: array
        description: Request meta
        items:
          $ref: '#/definitions/Meta'
        
  ItemListSort:
    type: string
    enum:
      - CREATED_AT_DESC
      - CREATED_AT_ASC
      - MODIFIED_AT_DESC
      - MODIFIED_AT_ASC
      - SCORE_DESC
      - SCORE_ASC

  CategoryListSort:
    type: string
    enum:
      - CREATED_AT_DESC
      - CREATED_AT_ASC
      - MODIFIED_AT_DESC
      - MODIFIED_AT_ASC
      - SCORE_DESC
      - SCORE_ASC
      
  Meta:
    type: object
    description: Key-value pair that can be used to add meta data to objects (items, categories, etc)
    properties:
      key:
        type: string
      value:
        type: string
        
  InternalServerError:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
        
  Forbidden:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
        
  BadRequest:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
        
  NotImplemented:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
        
  NotFound:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
